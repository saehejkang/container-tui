---
phase: 01-panel-layout-visuals
plan: "01"
type: execute
wave: 1
depends_on: []
files_modified:
  - pkg/containers.go
autonomous: true
requirements:
  - TUI-01

must_haves:
  truths:
    - "A Container struct exists with Name, Status, CPUPercent, MemoryMB fields"
    - "FetchContainers() runs 'container list' and returns []Container"
    - "Container status values are normalized to 'running', 'stopped', or 'error'"
  artifacts:
    - path: "pkg/containers.go"
      provides: "Container type and FetchContainers tea.Cmd function"
      exports: ["Container", "FetchContainersMsg", "FetchContainers"]
      min_lines: 60
  key_links:
    - from: "pkg/containers.go"
      to: "os/exec"
      via: "RunCommand call or direct exec.Command"
      pattern: "container.*list"
---

<objective>
Create the Container data model and CLI-backed fetch command that the rest of Phase 1 builds on.

Purpose: All container list rendering, status coloring, and resource bars require a typed Container struct populated from the real CLI. This plan produces that foundation.
Output: pkg/containers.go with Container type and FetchContainers tea.Cmd.
</objective>

<execution_context>
@/Users/kevingeorge/.claude/get-shit-done/workflows/execute-plan.md
@/Users/kevingeorge/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@pkg/exec.go
@ui/system/subcommands/status.go
</context>

<tasks>

<task type="auto">
  <name>Task 1: Container type and FetchContainers command</name>
  <files>pkg/containers.go</files>
  <action>
Create pkg/containers.go in package `pkg`. This file provides the data model and CLI-backed fetch command used by the container list panel.

Define the Container struct:
```go
type Container struct {
    Name      string
    Status    string  // normalized: "running", "stopped", "error"
    CPUPercent float64
    MemoryMB   float64
}
```

Define FetchContainersMsg as the message type returned from the async command:
```go
type FetchContainersMsg []Container
```

Define FetchContainers() as a tea.Cmd that:
1. Runs `container list` using RunCommand (or exec.Command directly, consistent with existing pkg/exec.go approach)
2. Parses the output line by line — the apple/container CLI outputs tab or space-separated rows. The first line is a header (skip it). Each subsequent line contains at minimum: NAME and STATUS columns. Parse defensively: use strings.Fields(), skip lines with < 2 fields.
3. Normalizes status: if strings.Contains(lower(status), "running") → "running"; if strings.Contains(lower(status), "error") or "fail" → "error"; everything else → "stopped"
4. CPU and memory are best-effort: if the CLI provides them (check fields[2] and fields[3]), parse as float64 using strconv.ParseFloat; if absent or unparseable, leave as 0.0
5. Returns FetchContainersMsg(containers)

Import: "strconv", "strings", "os/exec" (or reuse pkg.RunCommand), tea "github.com/charmbracelet/bubbletea"

Note: The `container list` output format may vary. Parse defensively — if parsing a field fails, zero-value is fine. Do NOT crash on malformed output.

Example output from `container list` (approximate format):
```
NAME        STATUS      CPU%    MEM
my-app      running     2.1     128
web-server  stopped     0       0
```

Keep the function signature:
```go
func FetchContainers() tea.Cmd {
    return func() tea.Msg {
        // ...
        return FetchContainersMsg(containers)
    }
}
```
  </action>
  <verify>
Run `go build ./...` from the project root. Must compile with zero errors.
Also run: `go vet ./pkg/...` — must produce no warnings.
  </verify>
  <done>
pkg/containers.go exists, exports Container struct (Name/Status/CPUPercent/MemoryMB), FetchContainersMsg type, and FetchContainers() tea.Cmd. `go build ./...` passes. Status normalization maps any "running"-containing string to "running", "error"/"fail" to "error", all else to "stopped".
  </done>
</task>

</tasks>

<verification>
`go build ./...` passes with no errors.
`go vet ./...` passes with no warnings.
pkg/containers.go exists and exports Container, FetchContainersMsg, FetchContainers.
</verification>

<success_criteria>
Container data model is defined and compiles cleanly. FetchContainers() returns a tea.Cmd that shells out to `container list` and produces typed Container values. Status field is normalized. CPU/memory parsed best-effort.
</success_criteria>

<output>
After completion, create `.planning/phases/01-panel-layout-visuals/01-01-SUMMARY.md`
</output>
